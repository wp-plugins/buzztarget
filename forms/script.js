/* ***************************************************** */// GLOBALS/* ***************************************************** */	BUZZTARGET_DOING_AJAX = false;/* ***************************************************** */// INIT JQUERY/* ***************************************************** */	jQuery(function ($){	// VALIDATE EMAIL	function isEmailValid (email)	{ 		var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;		return re.test(email);	}	// FORM SUBMIT EVENT	$(".buzztarget-submit").click(function (e)	{		e.preventDefault();				if (!BUZZTARGET_DOING_AJAX)		{			BUZZTARGET_DOING_AJAX = true;			var $this   = $(this);			var $form   = $this.parents("form").first();			var $email  = $form.find("input[type=text].email");			var $usrMsg = $form.find(".buzztarget-message")			var isValid = true;						$usrMsg.stop(false, true).slideUp("fast", function ()			{				$(this).removeClass("buzztarget-error buzztarget-success");			});						// VALIDATE FIELDS			$form.find("input[type=text].buzztarget-required").each(function ()			{				var $field = $(this);				if ($field.val().length <= 0)				{					$field.addClass("buzztarget-form-error");					isValid = false;				}				else				{					$field.removeClass("buzztarget-form-error");				}								if ($field.get(0) === $email.get(0))				{					if (!$field.hasClass("buzztarget-form-error"))					{						if (!isEmailValid($field.val()))						{							$field.addClass("buzztarget-form-error");							isValid = false;						}						else						{							$field.removeClass("buzztarget-form-error");						}					}				}			});						// SEND FIELD VALUES TO BACK-END IF VALID			if (isValid)			{				var $fname   = $form.find("input[type=text].fname");				var $lname   = $form.find("input[type=text].lname");				var $cname   = $form.find("input[type=text].cname");				var $title   = $form.find("input[type=text].title");				var $phoneno = $form.find("input[type=text].phoneno");								$form.find(".buzztarget-loader").stop(false, true).slideDown("fast");								$.post(					BUZZTARGET_AJAX_URL,					{						action:  "buzztarget_ajax_register",						email:   $email.val(),						fname:   $fname.length > 0   ? $fname.val()   : "",						lname:   $lname.length > 0   ? $lname.val()   : "",						cname:   $cname.length > 0   ? $cname.val()   : "",						title:   $title.length > 0   ? $title.val()   : "",						phoneno: $phoneno.length > 0 ? $phoneno.val() : "",						id:      $this.data("id")					},					function (resp)					{						try						{							var json = jQuery.parseJSON(resp);							if (json.code > 0)							{								// SUCCESS								$usrMsg.html(json.msg);								$form.find("input[type=text]").val("");								$usrMsg.stop(false, true).addClass("buzztarget-success").slideDown("fast");															}							else							{								// FAIL								$usrMsg.text(json.msg);								$usrMsg.stop(false, true).addClass("buzztarget-error").slideDown("fast");														}						}						catch (e)						{							// FAIL							$usrMsg.text("Error occured on server, please try again in a few seconds.");							$usrMsg.stop(false, true).addClass("buzztarget-error").slideDown("fast");						}					}				).always(function ()				{					BUZZTARGET_DOING_AJAX = false;					$form.find(".buzztarget-loader").stop(false, true).slideUp("fast");					setTimeout(function ()					{						$usrMsg.stop(false, true).slideUp("fast", function ()						{							$(this).removeClass("buzztarget-error buzztarget-success");						});					}, 4000);				});			}			else			{				BUZZTARGET_DOING_AJAX = false;			}		}	});});